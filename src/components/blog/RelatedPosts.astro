---
import { APP_BLOG } from "astrowind:config";

import { getRelatedPosts } from "~/utils/blog";
import type { Post } from "~/types";
import { getBlogPermalink } from "~/utils/permalinks";

export interface Props {
  post: Post;
}

const { post } = Astro.props;

const relatedPosts = post.tags ? await getRelatedPosts(post, 4) : [];
---

{
  APP_BLOG.isRelatedPostsEnabled && relatedPosts.length ? (
    <section class="mx-auto max-w-5xl px-4 py-10 md:py-14">
      <div class="mb-6 flex items-baseline justify-between">
        <h2 class="text-2xl font-bold text-brand-900 md:text-3xl">Publicaciones relacionadas</h2>
        <a href={getBlogPermalink()} class="btn text-sm">
          Ver todas las entradas
        </a>
      </div>
      <ul class="grid gap-4 sm:grid-cols-2">
        {relatedPosts.map((p) => (
          <li class="card p-4">
            <a href={`/${p.permalink}`} class="no-underline">
              <h3 class="text-lg font-semibold text-brand-900">{p.title}</h3>
            </a>
          </li>
        ))}
      </ul>
    </section>
  ) : null
}
